<!DOCTYPE html><html class="theme-next pisces" lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#fff"><link rel="preload" href="/fonts/Candyshop.otf" as="font" type="font/otf" crossorigin="anonymous"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css"><link href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=0.1.0" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/logo_square.png?v=0.1.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=0.1.0"><link rel="mask-icon" href="/images/logo_square.png?v=0.1.0" color="#fff"><meta name="keywords" content="SeaweedFS,分布式,文件系统,"><link rel="alternate" href="/atom.xml" title="Hi,ghostsf" type="application/atom+xml"><meta name="description" content="0x00 概述Github: https:&#x2F;&#x2F;github.com&#x2F;chrislusf&#x2F;seaweedfsSeaweedFS is a simple and highly scalable distributed file system, to store and serve billions of files fast! SeaweedFS implements an object store"><meta property="og:type" content="article"><meta property="og:title" content="简单且高度可扩展的分布式文件系统SeaweedFS"><meta property="og:url" content="https://ghostsf.com/seaweedfs/index.html"><meta property="og:site_name" content="Hi,ghostsf"><meta property="og:description" content="0x00 概述Github: https:&#x2F;&#x2F;github.com&#x2F;chrislusf&#x2F;seaweedfsSeaweedFS is a simple and highly scalable distributed file system, to store and serve billions of files fast! SeaweedFS implements an object store"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://raw.githubusercontent.com/chrislusf/seaweedfs/master/note/seaweedfs.png"><meta property="og:image" content="https://ghostsf.com/images/post/seaweed1.png"><meta property="og:image" content="https://ghostsf.com/images/post/seaweed2.png"><meta property="og:image" content="https://github.com/chrislusf/seaweedfs/wiki/FilerAsyncReplication.png"><meta property="og:image" content="https://github.com/chrislusf/seaweedfs/wiki/FilerAsyncBackupToCloud.png"><meta property="article:published_time" content="2020-03-06T16:08:21.000Z"><meta property="article:modified_time" content="2020-04-01T09:51:38.587Z"><meta property="article:author" content="ghostsf"><meta property="article:tag" content="SeaweedFS"><meta property="article:tag" content="分布式"><meta property="article:tag" content="文件系统"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://raw.githubusercontent.com/chrislusf/seaweedfs/master/note/seaweedfs.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",version:"0.1.0",sidebar:{position:"right",display:"always",offset:52,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!1,tabs:!0,motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},since:"1/6/2015 00:00:00",onlineAPI:"",site:{title:"Hi,ghostsf",subtitle:"",author:"ghostsf"},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},leancloud:{enable:!0,appID:"vBYFni3xYrGg1PUv2PQORyev-gzGzoHsz",appKey:"jfv0kKqHnkoGG0d3JBMwC4pJ"},favicon:{visibilitychange:!0,narmal:"/images/favicon.ico",hidden:"/images/failure.ico",show_text:"(/≧▽≦/)咦！又好了！",hide_text:"(●—●)喔哟，崩溃啦！"}}</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/disqusjs@1.2.2/dist/disqus.js"></script><link rel="canonical" href="https://ghostsf.com/seaweedfs/"><title>简单且高度可扩展的分布式文件系统SeaweedFS | Hi,ghostsf</title><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-139866883-1","auto"),ga("send","pageview")</script><script data-ad-client="ca-pub-9937192623475080" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d34c1ea90fbad8193b675c4c0767b8e2";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><meta name="generator" content="Hexo 4.2.0"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN" class="theme-darling"><div class="container sidebar-position-right page-post-detail"><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-首页"><a href="/" rel="section"><i class="menu-item-icon fas fa-meteor"></i><br>首页</a></li><li class="menu-item menu-item-归档"><a href="/archives/" rel="section"><i class="menu-item-icon fas fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-实验室"><a href="javascript:;" rel="section"><i class="menu-item-icon fas fa-magic"></i><br>实验室</a><ul class="submenu submenu-实验室"><li class="submenu-item submenu-item-lemonsaas-a"><a href="https://a.lemonsaas.com/" rel="section" target="_blank">LemonSaaS-A</a></li><li class="submenu-item submenu-item-监控"><a href="https://status.ghostsf.com/" rel="section" target="_blank">监控</a></li><li class="submenu-item submenu-item-nas"><a href="https://nas.ghostsf.com:2222" rel="section" target="_blank">NAS</a></li><li class="submenu-item submenu-item-下载机"><a href="http://nas.ghostsf.com:3333" rel="section" target="_blank">下载机</a></li></ul></li><li class="menu-item menu-item-投喂"><a href="/donate/" rel="section"><i class="menu-item-icon fas fa-utensils"></i><br>投喂</a></li><li class="menu-item menu-item-友链"><a href="/friends/" rel="section"><i class="menu-item-icon fas fa-mars-stroke"></i><br>友链</a></li><li class="menu-item menu-item-留言板"><a href="/message/" rel="section"><i class="menu-item-icon fas fa-comment-dots"></i><br>留言板</a></li><li class="menu-item menu-item-关于"><a href="/i/" rel="section"><i class="menu-item-icon rocket"></i><br>关于</a></li><li class="menu-item search"><form class="search-form"><input name="keyword" type="text" class="search-input" placeholder="搜索"> <button type="submit" class="search-submit"><i class="fas fa-search"></i></button></form></li></ul></nav><div class="site-brand-wrapper" style="background-image:url(/images/header-dsl.jpg)"><div class="site-meta"><div class="custom-logo-site-title"><div class="brand"><span class="logo-line-before"><i></i></span><div class="site-title"><div id="animate" class="animate"><span>H</span><span>i</span><span>,</span><span>g</span><span>h</span><span>o</span><span>s</span><span>t</span><span>s</span><span>f</span></div><div id="guide" class="guide"><span>H</span><span>i</span><span>,</span><span>g</span><span>h</span><span>o</span><span>s</span><span>t</span><span>s</span><span>f</span></div></div><span class="logo-line-after"><i></i></span></div></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><div class="site-master" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-master-avatar scaleup" itemprop="image" src="/images/logo_square.png" alt="ghostsf"><h2 class="site-master-description scaleup" itemprop="description"><span>Do what i love ，</span><span>and just do it！</span></h2></div></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-date"><div class="post-month">03月</div><div class="post-day">06</div></div><div class="post-badge"><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%8A%80%E6%9C%AF%E6%A0%88/" itemprop="url" rel="index"><span itemprop="name">技术栈</span></a></span></div><div class="post-block"><link itemprop="mainEntityOfPage" href="https://ghostsf.com/seaweedfs/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="ghostsf"><meta itemprop="description" content=""><meta itemprop="image" content="/images/logo_square.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Hi,ghostsf"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">简单且高度可扩展的分布式文件系统SeaweedFS</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-06T16:08:21+00:00">2020-03-06</time> </span><span class="post-wordcount"><span class="post-meta-divider">•</span> <span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">字数统计</span> <span title="字数统计">4013</span> </span><span id="/seaweedfs/" class="leancloud_visitors" data-flag-title="简单且高度可扩展的分布式文件系统SeaweedFS"><span class="post-meta-divider">•</span> <span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">被</span> <span class="leancloud-visitors-count"></span> <span class="post-meta-item-text">人看爆</span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="0x00-概述"><a href="#0x00-概述" class="headerlink" title="0x00 概述"></a>0x00 概述</h1><p><img src="https://raw.githubusercontent.com/chrislusf/seaweedfs/master/note/seaweedfs.png" alt="SeaweedFS Logo"></p><p>Github: <a href="https://github.com/chrislusf/seaweedfs" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs</a></p><blockquote><p>SeaweedFS is a simple and highly scalable distributed file system, to store and serve billions of files fast! SeaweedFS implements an object store with O(1) disk seek, transparent cloud integration, and an optional Filer with POSIX interface, supporting S3 API, Rack-Aware Erasure Coding for warm storage, FUSE mount, Hadoop compatible, WebDAV.</p></blockquote><p>SeaweedFS是一个简单且高度可扩展的分布式文件系统，可以快速存储和提供数十亿个文件！SeaweedFS通过 O(1) 磁盘搜索，透明云集成以及带有POSIX接口的可选Filer，实现了对象存储，支持S3 API，用于热存储的机架感知擦除编码，FUSE安装，Hadoop兼容，WebDAV。</p><a id="more"></a><h1 id="0x01-基础概念"><a href="#0x01-基础概念" class="headerlink" title="0x01 基础概念"></a>0x01 基础概念</h1><p>随着业务量增长，一个系统需要存储上百万文件的情况越来越多，尤其是互联网网站。在这种情况下依然使用传统磁盘/共享存储的方式进行支持会有以下问题：</p><ul><li><p>文件的备份、恢复困难，大量文件的copy 耗时耗力</p></li><li><p>文件数量暴增占满操作系统文件系统inode，导致磁盘空间虽然没有用完但是因为inode用尽无法使用</p></li><li><p>文件读取效率太低，无法应对高并发读取要求<br>针对以上问题，facebook 提出了自己的方案 <a href="http://www.usenix.org/event/osdi10/tech/full_papers/Beaver.pdf" target="_blank" rel="noopener">Facebook’s Haystack design paper</a> 。 之后各种实现出现，如tfs、MogileFS、GlusterFS等，其中Seaweedfs是一个比较优秀的实现。具有效率高、结构简单、代码清晰等优点。</p></li></ul><p>在逻辑上Seaweedfs的几个概念：</p><table><thead><tr><th>概念</th><th>解释</th></tr></thead><tbody><tr><td>Node</td><td>系统抽象的节点，抽象为DataCenter、Rack、DataNode</td></tr><tr><td>DataCenter</td><td>数据中心，对应现实中的不同机房</td></tr><tr><td>Rack</td><td>机架，对应现实中的机柜</td></tr><tr><td>Datanode</td><td>存储节点，用于管理、存储逻辑卷，其实就是Volume server（卷服务器），而Volume server下是有很多个逻辑卷的</td></tr><tr><td>Volume</td><td>逻辑卷，存储的逻辑结构，逻辑卷下存储Needle</td></tr><tr><td>Needle</td><td>逻辑卷中的Object，对应存储的文件（每个文件有一个唯一needleID）</td></tr><tr><td>Collection</td><td>文件集，可以分布在多个逻辑卷上</td></tr></tbody></table><p><strong>结构说明</strong>：<br><img src="/images/post/seaweed1.png" alt="结构说明"></p><h1 id="0x02-组成部分"><a href="#0x02-组成部分" class="headerlink" title="0x02 组成部分"></a>0x02 组成部分</h1><ol><li><p>基础部分：Master server + Volume server</p></li><li><p>扩展部分：Filer server + Cronjob server (Replication-job) + S3 server</p><blockquote><p>值得注意的一点：外部与 Master Server、Volume Server 和 Filer 进行通信的方式是 HTTP API。API的用法官网有<a href="https://github.com/chrislusf/seaweedfs/wiki/Master-Server-API" target="_blank" rel="noopener">详细说明</a>。</p></blockquote></li></ol><p><strong>部署结构</strong>：<br><img src="/images/post/seaweed2.png" alt="部署说明"></p><h1 id="0x03-快速上手"><a href="#0x03-快速上手" class="headerlink" title="0x03 快速上手"></a>0x03 快速上手</h1><p>从 <a href="https://github.com/chrislusf/seaweedfs/releases" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/releases</a> 下载最新版本</p><p>解压缩下载的文件，只会找到一个可执行文件，在大多数系统上是“ weed”，在Windows上是“ weed.exe”。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./weed -h # to check available options</span><br></pre></td></tr></table></figure><h2 id="配置运行Weed-Master-server"><a href="#配置运行Weed-Master-server" class="headerlink" title="配置运行Weed Master server"></a>配置运行Weed Master server</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./weed master -h # to check available options</span><br></pre></td></tr></table></figure><p>如果不需要复制，就足够了。<code>mdir</code>选项用于配置保存生成的序列文件ID的文件夹。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./weed master -mdir="."</span><br><span class="line">./weed master -mdir="." -ip=xxx.xxx.xxx.xxx # usually set the ip instead the default "localhost"</span><br></pre></td></tr></table></figure><h2 id="配置运行Weed-Volume-Server"><a href="#配置运行Weed-Volume-Server" class="headerlink" title="配置运行Weed Volume Server"></a>配置运行Weed Volume Server</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./weed volume -h # to check available options</span><br></pre></td></tr></table></figure><p>通常，卷服务器分布在不同的服务器上。它们可以具有不同的磁盘空间，甚至可以具有不同的操作系统。</p><p>通常，你需要指定可用磁盘空间，Weed Master地址和存储文件夹。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./weed volume -max=100 -mserver="localhost:9333" -dir="./data"</span><br></pre></td></tr></table></figure><p><strong>PS</strong>：设置一台Weed Master server和一台Weed Volume Server，可以用weed server简写：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./weed server -dir="./data"</span><br><span class="line"><span class="meta">#</span><span class="bash"> same, just specifying the default values</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> use <span class="string">"weed server -h"</span> to find out more</span></span><br><span class="line">./weed server -master.port=9333 -volume.port=8080 -dir="./data"</span><br></pre></td></tr></table></figure><h2 id="测试SeaweedFS"><a href="#测试SeaweedFS" class="headerlink" title="测试SeaweedFS"></a>测试SeaweedFS</h2><p>随着主服务器和卷服务器的启动，现在呢？让我们将大量文件注入系统！</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./weed upload -dir="/some/big/folder"</span><br></pre></td></tr></table></figure><p>此命令将以递归方式上载所有文件。或者，您可以指定要包括的文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./weed upload -dir="/some/big/folder" -include=*.txt</span><br></pre></td></tr></table></figure><p>然后，您只需检查“ du -m -s / some / big / folder”即可查看操作系统的实际磁盘使用情况，并将其与“ / data”下的文件大小进行比较。通常，如果您要上传大量文本文件，则消耗的磁盘大小会小得多，因为文本文件会自动压缩。</p><h1 id="0x04-在docker中使用"><a href="#0x04-在docker中使用" class="headerlink" title="0x04 在docker中使用"></a>0x04 在docker中使用</h1><p>与docker一起使用很容易，因为它在本地运行，您可以像上面那样传递所有args。但是您不必担心“ -ip”。入口点脚本将对其进行处理。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 9333:9333 --name master chrislusf/seaweedfs master -ip=master</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 8080:8080 -p 18080:18080 --name volume --link master chrislusf/seaweedfs volume -max=5 -mserver="master:9333" -port=8080</span><br></pre></td></tr></table></figure><h2 id="使用compose"><a href="#使用compose" class="headerlink" title="使用compose"></a>使用compose</h2><p>但是使用Compose最简单。要启动，只需运行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose -f docker/seaweedfs-compose.yml -p seaweedfs up</span><br></pre></td></tr></table></figure><p>您可以使用映像“ chrislusf / seaweedfs”或在根目录中使用dockerfile构建自己的映像。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name weed chrislusf/seaweedfs server</span><br></pre></td></tr></table></figure><h2 id="从dockerfile构建image"><a href="#从dockerfile构建image" class="headerlink" title="从dockerfile构建image"></a>从dockerfile构建image</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/chrislusf/seaweedfs.git</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build --no-cache -t 'chrislusf/seaweedfs' .</span><br></pre></td></tr></table></figure><h2 id="构建docker-image"><a href="#构建docker-image" class="headerlink" title="构建docker image"></a>构建docker image</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mv Dockerfile Dockerfile.minimal</span><br><span class="line">mv Dockerfile.go_build Dockerfile</span><br><span class="line">docker build --no-cache -t 'chrislusf/seaweedfs' .</span><br></pre></td></tr></table></figure><h2 id="生产使用"><a href="#生产使用" class="headerlink" title="生产使用"></a>生产使用</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> start our weed server daemonized</span></span><br><span class="line">docker run --name weed -d -p 9333:9333 -p 8080:8080 -p 18080:8080 \</span><br><span class="line">  -v /opt/weedfs/data:/data chrislusf/seaweedfs server -dir="/data" \ </span><br><span class="line">  -publicIp="$(curl -s cydev.ru/ip)"</span><br></pre></td></tr></table></figure><p>现在，SeaweedFS服务器将是持久性的，并且可以通过主机上的localhost：9333，：8080和：18080进行访问。不要忘记为指定正确的“ -publicIp”。</p><h1 id="0x05-组成部分介绍"><a href="#0x05-组成部分介绍" class="headerlink" title="0x05 组成部分介绍"></a>0x05 组成部分介绍</h1><h2 id="Master-Server"><a href="#Master-Server" class="headerlink" title="Master Server"></a>Master Server</h2><blockquote><p>Master是不存储数据的，只做集群协调，类似于Zookeeper的作用。</p></blockquote><p>Master Server API 详见 <a href="https://github.com/chrislusf/seaweedfs/wiki/Master-Server-API" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/wiki/Master-Server-API</a></p><p><strong>Tips</strong>：可以使用＆pretty = y附加到任何HTTP API，以查看格式化的json输出。</p><h3 id="分配一个fileId，用于接下来的存储文件"><a href="#分配一个fileId，用于接下来的存储文件" class="headerlink" title="分配一个fileId，用于接下来的存储文件"></a>分配一个fileId，用于接下来的存储文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Basic Usage:</span></span><br><span class="line">curl http://localhost:9333/dir/assign</span><br><span class="line">&#123;"count":1,"fid":"3,01637037d6","url":"127.0.0.1:8080",</span><br><span class="line"> "publicUrl":"localhost:8080"&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> To assign with a specific replication <span class="built_in">type</span>:</span></span><br><span class="line">curl "http://localhost:9333/dir/assign?replication=001"</span><br><span class="line"><span class="meta">#</span><span class="bash"> To specify how many file ids to reserve</span></span><br><span class="line">curl "http://localhost:9333/dir/assign?count=5"</span><br><span class="line"><span class="meta">#</span><span class="bash"> To assign a specific data center</span></span><br><span class="line">curl "http://localhost:9333/dir/assign?dataCenter=dc1"</span><br></pre></td></tr></table></figure><h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">curl "http://localhost:9333/dir/lookup?volumeId=3&amp;pretty=y"</span><br><span class="line">&#123;</span><br><span class="line">  "locations": [</span><br><span class="line">    &#123;</span><br><span class="line">      "publicUrl": "localhost:8080",</span><br><span class="line">      "url": "localhost:8080"</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> Other usages:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> You can actually use the file id to lookup, <span class="keyword">if</span> you are lazy to parse the file id.</span></span><br><span class="line">curl "http://localhost:9333/dir/lookup?volumeId=3,01637037d6"</span><br><span class="line"><span class="meta">#</span><span class="bash"> If you know the collection, specify it since it will be a little faster</span></span><br><span class="line">curl "http://localhost:9333/dir/lookup?volumeId=3&amp;collection=turbo"</span><br></pre></td></tr></table></figure><h3 id="强制垃圾收集"><a href="#强制垃圾收集" class="headerlink" title="强制垃圾收集"></a>强制垃圾收集</h3><p>如果您的系统有许多删除操作，则不会同步回收已删除文件的磁盘空间。有一个后台作业可检查卷磁盘使用情况。如果空白空间大于阈值（默认值为0.3），真空作业将使该卷成为只读卷，仅使用现有文件创建一个新卷，然后打开新卷。如果嫌麻烦或正在做一些测试，请用这种方法清理未使用的空间。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl "http://localhost:9333/vol/vacuum"</span><br><span class="line">curl "http://localhost:9333/vol/vacuum?garbageThreshold=0.4"</span><br></pre></td></tr></table></figure><p>garbageThreshold = 0.4是可选的，并且不会更改默认阈值。您可以使用不同的默认垃圾阈值启动卷主机。此操作并非易事。它将尝试制作.dat和.idx文件的副本，跳过已删除的文件，并切换到新文件，删除旧文件。</p><h3 id="预分配卷"><a href="#预分配卷" class="headerlink" title="预分配卷"></a>预分配卷</h3><p>一个卷服务一次写入。如果需要增加并发性，则可以预分配大量卷。这是例子。也可以组合所有不同的选项。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> specify a specific replication</span></span><br><span class="line">curl "http://localhost:9333/vol/grow?replication=000&amp;count=4"</span><br><span class="line">&#123;"count":4&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> specify a collection</span></span><br><span class="line">curl "http://localhost:9333/vol/grow?collection=turbo&amp;count=4"</span><br><span class="line"><span class="meta">#</span><span class="bash"> specify data center</span></span><br><span class="line">curl "http://localhost:9333/vol/grow?dataCenter=dc1&amp;count=4"</span><br><span class="line"><span class="meta">#</span><span class="bash"> specify ttl</span></span><br><span class="line">curl "http://localhost:9333/vol/grow?ttl=5d&amp;count=4"</span><br></pre></td></tr></table></figure><p>这将生成4个空卷。</p><h3 id="删除文件集"><a href="#删除文件集" class="headerlink" title="删除文件集"></a>删除文件集</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> delete a collection</span></span><br><span class="line">curl "http://localhost:9333/col/delete?collection=benchmark&amp;pretty=y"</span><br></pre></td></tr></table></figure><h3 id="检查系统状态"><a href="#检查系统状态" class="headerlink" title="检查系统状态"></a>检查系统状态</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl "http://10.0.2.15:9333/cluster/status?pretty=y"</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl "http://localhost:9333/dir/status?pretty=y"</span><br></pre></td></tr></table></figure><h2 id="Volume-Server"><a href="#Volume-Server" class="headerlink" title="Volume Server"></a>Volume Server</h2><blockquote><p>这个就是所谓的“Data Node”数据节点，用于挂载磁盘存储文件。Volume Server与Master Server通信，受Master控制。可以动态的增加和减少VolumeServer，这一点比另一个云存储MinIO要强得多。</p></blockquote><p>Volume Server API 可详见 <a href="https://github.com/chrislusf/seaweedfs/wiki/Volume-Server-API" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/wiki/Volume-Server-API</a></p><p><strong>Tips</strong>：可以使用＆pretty = y附加到任何HTTP API，以查看格式化的json输出。</p><h3 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -F file=@/home/ghostsf/myphoto.jpg http://127.0.0.1:8080/3,01637037d6</span><br><span class="line">&#123;"size": 43234&#125;</span><br></pre></td></tr></table></figure><p>返回的大小是存储在SeaweedFS上的大小，有时文件会根据mime类型自动压缩。</p><h3 id="直接上传文件"><a href="#直接上传文件" class="headerlink" title="直接上传文件"></a>直接上传文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -F file=@/home/ghostsf/myphoto.jpg http://localhost:9333/submit</span><br><span class="line">&#123;"fid":"3,01fbe0dc6f1f38","fileName":"myphoto.jpg","fileUrl":"localhost:8080/3,01fbe0dc6f1f38","size":68231&#125;</span><br></pre></td></tr></table></figure><p>这个API只是为了方便。主服务器将获得一个文件id并将文件存储到正确的卷服务器。这是一个很方便的API，在分配文件id时不支持不同的参数。</p><h3 id="访问文件"><a href="#访问文件" class="headerlink" title="访问文件"></a>访问文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://127.0.0.1:8080/3,01637037d6</span><br></pre></td></tr></table></figure><h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X DELETE http://127.0.0.1:8080/3,01637037d6</span><br></pre></td></tr></table></figure><h3 id="查看分块大文件的清单文件内容"><a href="#查看分块大文件的清单文件内容" class="headerlink" title="查看分块大文件的清单文件内容"></a>查看分块大文件的清单文件内容</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://127.0.0.1:8080/3,01637037d6?cm=false</span><br></pre></td></tr></table></figure><h3 id="检查卷服务器状态"><a href="#检查卷服务器状态" class="headerlink" title="检查卷服务器状态"></a>检查卷服务器状态</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl "http://localhost:8080/status?pretty=y"</span><br></pre></td></tr></table></figure><h2 id="Filer-Server"><a href="#Filer-Server" class="headerlink" title="Filer Server"></a>Filer Server</h2><p>文件管理器（Filer）可以用来 浏览文件和目录，以及add/delete files, and even browse the sub directories and files，还有检索、重命名等。</p><h3 id="配置启动"><a href="#配置启动" class="headerlink" title="配置启动"></a>配置启动</h3><p>将filer.toml文件添加到当前目录，或$ HOME / .seaweedfs / 或 / etc / seaweedfs /filer.toml</p><p>可以通过以下方式生成</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weed scaffold -config=filer -output="."</span><br></pre></td></tr></table></figure><p>查看的方式：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weed scaffold -config=filer</span><br></pre></td></tr></table></figure><p>filer.toml文件内容：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[leveldb]</span><br><span class="line">enabled = true</span><br><span class="line">dir = "."					# directory to store level db files</span><br></pre></td></tr></table></figure><p>两种方式启动：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> assuming you already started weed master and weed volume</span></span><br><span class="line">weed filer</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Or assuming you have nothing started yet,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> this <span class="built_in">command</span> starts master server, volume server, and filer <span class="keyword">in</span> one shot. </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> It<span class="string">'s strictly the same as starting them separately.</span></span></span><br><span class="line">weed server -filer=true</span><br></pre></td></tr></table></figure><h3 id="管理文件"><a href="#管理文件" class="headerlink" title="管理文件"></a>管理文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Basic Usage:</span></span><br><span class="line">	//create or overwrite the file, the directories /path/to will be automatically created</span><br><span class="line">	POST /path/to/file</span><br><span class="line">	//get the file content</span><br><span class="line">	GET /path/to/file</span><br><span class="line">	//create or overwrite the file, the filename in the multipart request will be used</span><br><span class="line">	POST /path/to/</span><br><span class="line">	//return a json format subdirectory and files listing</span><br><span class="line">	GET /path/to/</span><br><span class="line">        Accept: application/json</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> options <span class="keyword">for</span> POST a file:</span></span><br><span class="line">	// set file TTL for Cassandra or Redis filer store.</span><br><span class="line">	POST /path/to/file?ttl=1d</span><br><span class="line">	// set file mode when creating or overwriting a file</span><br><span class="line">	POST /path/to/file?mode=0755</span><br></pre></td></tr></table></figure><h3 id="列出目录下的文件"><a href="#列出目录下的文件" class="headerlink" title="列出目录下的文件"></a>列出目录下的文件</h3><p>这仅适用于嵌入式文件管理器。</p><p>一些文件夹可能非常大。为了有效地列出文件，我们使用非传统方式来迭代文件。每个分页都提供一个“ lastFileName”和一个“ limit = x”。文件管理器在O（log（n））时间中找到“ lastFileName”，并检索接下来的x个文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">List files under a directory</span><br><span class="line">This is for embedded filer only.</span><br><span class="line"></span><br><span class="line">Some folder can be very large. To efficiently list files, we use a non-traditional way to iterate files. Every pagination you provide a "lastFileName", and a "limit=x". The filer locate the "lastFileName" in O(log(n)) time, and retrieve the next x files.</span><br><span class="line"></span><br><span class="line">curl  "http://localhost:8888/javascript/?pretty=y&amp;lastFileName=new_name.js&amp;limit=2"</span><br><span class="line">&#123;</span><br><span class="line">  "Directory": "/javascript/",</span><br><span class="line">  "Files": [</span><br><span class="line">    &#123;</span><br><span class="line">      "name": "report.js",</span><br><span class="line">      "fid": "7,0254f1f3fd"</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><h4 id="删除文件-1"><a href="#删除文件-1" class="headerlink" title="删除文件"></a>删除文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> curl -X DELETE http://localhost:8888/path/to/file</span></span><br></pre></td></tr></table></figure><h4 id="删除文件夹"><a href="#删除文件夹" class="headerlink" title="删除文件夹"></a>删除文件夹</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// recursively delete all files and folders under a path</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> curl -X DELETE http://localhost:8888/path/to/dir?recursive=<span class="literal">true</span></span></span><br><span class="line">// recursively delete everything, ignoring any recursive error</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> curl -X DELETE http://localhost:8888/path/to/dir?recursive=<span class="literal">true</span>&amp;ignoreRecursiveError=<span class="literal">true</span></span></span><br><span class="line"></span><br><span class="line">// For Experts Only: remove filer directories only, without removing data chunks. </span><br><span class="line">// see https://github.com/chrislusf/seaweedfs/pull/1153</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> curl -X DELETE http://localhost:8888/path/to?recursive=<span class="literal">true</span>&amp;skipChunkDeletion=<span class="literal">true</span></span></span><br></pre></td></tr></table></figure><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>Filer具有连接到Master的持久客户端，以获取所有卷的位置更新。没有回调来查找卷ID位置。官方说明参见：<a href="https://github.com/chrislusf/seaweedfs/wiki/Directories-and-Files#architecture" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/wiki/Directories-and-Files#architecture</a></p><h3 id="mount挂载"><a href="#mount挂载" class="headerlink" title="mount挂载"></a>mount挂载</h3><p>weed mount 功能需要配合 Filer 才能使用，这样可以在服务器上用命令行操作文件。支持的操作如下：</p><ul><li>file read / write</li><li>create new file</li><li>mkdir</li><li>list</li><li>remove</li><li>rename</li><li>chmod</li><li>chown</li><li>soft link</li><li>display free disk space</li></ul><p>详见：<a href="https://github.com/chrislusf/seaweedfs/wiki/Mount" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/wiki/Mount</a></p><h3 id="Amazon-S3-API"><a href="#Amazon-S3-API" class="headerlink" title="Amazon S3 API"></a>Amazon S3 API</h3><p>为了与<code>Amazon S3 API</code>兼容，提供了单独的<code>weed s3</code>命令。与在云上操作文件相比，这在读取或写入文件时提供了更快的访问权限。</p><p><code>weed s3</code>将启动无状态网关服务器，以将<code>Amazon S3 API</code>桥接到<code>SeaweedFS Filer</code>。为了方便起见，<code>weed server -s3</code>将启动主服务器，卷服务器，文件管理器和S3网关。</p><p>每个存储桶都存储在一个集合中，并且默认情况下映射到文件夹<code>/ buckets / &lt;bucket_name&gt;</code>。</p><p>通过删除整个集合，可以有效地删除存储桶。</p><p>当前，支持以下API。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// Object operations</span><br><span class="line">* PutObject</span><br><span class="line">* GetObject</span><br><span class="line">* HeadObject</span><br><span class="line">* CopyObject</span><br><span class="line">* DeleteObject</span><br><span class="line">* ListObjectsV2</span><br><span class="line">* ListObjectsV1</span><br><span class="line"></span><br><span class="line">// Bucket operations</span><br><span class="line">* PutBucket</span><br><span class="line">* DeleteBucket</span><br><span class="line">* HeadBucket</span><br><span class="line">* ListBuckets</span><br><span class="line"></span><br><span class="line">// Multipart upload operations</span><br><span class="line">* NewMultipartUpload</span><br><span class="line">* CompleteMultipartUpload</span><br><span class="line">* AbortMultipartUpload</span><br><span class="line">* ListMultipartUploads</span><br><span class="line">* CopyObjectPart</span><br></pre></td></tr></table></figure><h1 id="0x06-异步备份"><a href="#0x06-异步备份" class="headerlink" title="0x06 异步备份"></a>0x06 异步备份</h1><h2 id="异步复制到另一个Filer"><a href="#异步复制到另一个Filer" class="headerlink" title="异步复制到另一个Filer"></a>异步复制到另一个Filer</h2><p>应该有两个Seaweed文件系统正在运行，可能跨数据中心运行。每个服务器都应具有其文件服务器，主服务器和卷服务器。</p><p><img src="https://github.com/chrislusf/seaweedfs/wiki/FilerAsyncReplication.png" alt="架构图"></p><p>详见：<a href="https://github.com/chrislusf/seaweedfs/wiki/Async-Replication-to-another-Filer" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/wiki/Async-Replication-to-another-Filer</a></p><h2 id="备份到云"><a href="#备份到云" class="headerlink" title="备份到云"></a>备份到云</h2><p>诸如Amazon S3，Google Cloud Storage，Azure，Backblaze B2等云存储选项非常适合备份。</p><p>Filer中的每个文件更改都会触发通知发送到消息队列。<code>weed replicate</code>过程将从消息队列中读取，读取实际文件内容，然后将更新发送到云接收器。</p><p><img src="https://github.com/chrislusf/seaweedfs/wiki/FilerAsyncBackupToCloud.png" alt="结构图"></p><p>详见：<a href="https://github.com/chrislusf/seaweedfs/wiki/Backup-to-Cloud" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/wiki/Backup-to-Cloud</a></p><h1 id="0x07-进阶"><a href="#0x07-进阶" class="headerlink" title="0x07 进阶"></a>0x07 进阶</h1><h2 id="复写配置"><a href="#复写配置" class="headerlink" title="复写配置"></a>复写配置</h2><p>SeaweedFS可以支持复制。复制不是在文件级别而是在卷级别实现的。</p><h3 id="怎么用？"><a href="#怎么用？" class="headerlink" title="怎么用？"></a>怎么用？</h3><ol><li><p>start weed master, and optionally specify the default replication type</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./weed master -defaultReplication=001</span><br></pre></td></tr></table></figure></li><li><p>start volume servers as this:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./weed volume -port=8081 -dir=/tmp/1 -max=100 -mserver="master_address:9333" -dataCenter=dc1 -rack=rack1</span><br><span class="line">./weed volume -port=8082 -dir=/tmp/2 -max=100 -mserver="master_address:9333" -dataCenter=dc1 -rack=rack1</span><br></pre></td></tr></table></figure></li></ol><p>On another rack,</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./weed volume -port=8081 -dir=/tmp/1 -max=100 -mserver="master_address:9333" -dataCenter=dc1 -rack=rack2</span><br><span class="line">./weed volume -port=8082 -dir=/tmp/2 -max=100 -mserver="master_address:9333" -dataCenter=dc1 -rack=rack2</span><br></pre></td></tr></table></figure><p>No change to Submitting, Reading, and Deleting files.</p><h3 id="复写类型的含义"><a href="#复写类型的含义" class="headerlink" title="复写类型的含义"></a>复写类型的含义</h3><p><em>Note: This subject to change.</em></p><table><thead><tr><th>Value</th><th>Meaning</th></tr></thead><tbody><tr><td>000</td><td>no replication, just one copy</td></tr><tr><td>001</td><td>replicate once on the same rack</td></tr><tr><td>010</td><td>replicate once on a different rack in the same data center</td></tr><tr><td>100</td><td>replicate once on a different data center</td></tr><tr><td>200</td><td>replicate twice on two other different data center</td></tr><tr><td>110</td><td>replicate once on a different rack, and once on a different data center</td></tr><tr><td>…</td><td>…</td></tr></tbody></table><p>So if the replication type is xyz</p><table><thead><tr><th>Column</th><th>Meaning</th></tr></thead><tbody><tr><td><strong>x</strong></td><td>number of replica in other data centers</td></tr><tr><td><strong>y</strong></td><td>number of replica in other racks in the same data center</td></tr><tr><td><strong>z</strong></td><td>number of replica in other servers in the same rack</td></tr></tbody></table><p>x,y,z each can be 0, 1, or 2. So there are 9 possible replication types, and can be easily extended. Each replication type will physically create x+y+z+1 copies of volume data files.</p><h2 id="大文件处理"><a href="#大文件处理" class="headerlink" title="大文件处理"></a>大文件处理</h2><p>为了支持大文件，SeaweedFS支持以下两种文件：</p><ul><li>块文件。每个块文件实际上只是SeaweedFS的普通文件。</li><li>块清单。一个带有所有块列表的简单json文件。</li></ul><p>更多详见：<a href="https://github.com/chrislusf/seaweedfs/wiki/Large-File-Handling" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/wiki/Large-File-Handling</a></p><h2 id="安全配置"><a href="#安全配置" class="headerlink" title="安全配置"></a>安全配置</h2><p><code>weed scaffold -config=security</code> 生成<code>security.toml</code></p><p><code>security.toml</code>文件示例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Put this file to one of the location, with descending priority</span></span><br><span class="line"><span class="meta">#</span><span class="bash">    ./security.toml</span></span><br><span class="line"><span class="meta">#</span><span class="bash">    <span class="variable">$HOME</span>/.seaweedfs/security.toml</span></span><br><span class="line"><span class="meta">#</span><span class="bash">    /etc/seaweedfs/security.toml</span></span><br><span class="line"></span><br><span class="line">[jwt.signing]</span><br><span class="line">key = "blahblahblahblah"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> all grpc tls authentications are mutual </span></span><br><span class="line">[grpc]</span><br><span class="line">ca = "/Users/ghostsf/.seaweedfs/out/SeaweedFS_CA.crt"</span><br><span class="line"></span><br><span class="line">[grpc.volume]</span><br><span class="line">cert = "/Users/ghostsf/.seaweedfs/out/volume01.crt"</span><br><span class="line">key  = "/Users/ghostsf/.seaweedfs/out/volume01.key"</span><br><span class="line"></span><br><span class="line">[grpc.master]</span><br><span class="line">cert = "/Users/ghostsf/.seaweedfs/out/master01.crt"</span><br><span class="line">key  = "/Users/ghostsf/.seaweedfs/out/master01.key"</span><br><span class="line"></span><br><span class="line">[grpc.filer]</span><br><span class="line">cert = "/Users/ghostsf/.seaweedfs/out/filer01.crt"</span><br><span class="line">key  = "/Users/ghostsf/.seaweedfs/out/filer01.key"</span><br><span class="line"></span><br><span class="line">[grpc.client]</span><br><span class="line">cert = "/Users/ghostsf/.seaweedfs/out/client01.crt"</span><br><span class="line">key  = "/Users/ghostsf/.seaweedfs/out/client01.key"</span><br></pre></td></tr></table></figure><h1 id="0x08-各语言的客户端"><a href="#0x08-各语言的客户端" class="headerlink" title="0x08 各语言的客户端"></a>0x08 各语言的客户端</h1><p>目前官方提供了足够的Api，各种语言的客户端也都有了。</p><p>详见：<a href="https://github.com/chrislusf/seaweedfs/wiki/Client-Libraries" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/wiki/Client-Libraries</a></p><h1 id="0x09-不足与问题"><a href="#0x09-不足与问题" class="headerlink" title="0x09 不足与问题"></a>0x09 不足与问题</h1><ol><li>seaweedfs 采用的是同步式复写有以下几个问题：</li></ol><ul><li><p>当在某个volume-server 下线又上线恢复的情况下，没有自动的同步机制</p></li><li><p>同步复写需要等待每个节点都复写成功，效率相对较低</p></li><li><p>虽然节点的上下线会快速通过心跳通知master节点，但是仍然存在一定的延迟，期间Volume-Server在复写的时候可能会出现因为复写已经下线的volume-server导致上传失败的情况</p></li></ul><ol start="2"><li>seaweedfs目前在权限管理方面还相对比较弱，目前仅有一个白名单控制机制，来控制外部的读写权限/恶意删除。</li></ol><h1 id="0x0A-遇到问题怎么办"><a href="#0x0A-遇到问题怎么办" class="headerlink" title="0x0A 遇到问题怎么办"></a>0x0A 遇到问题怎么办</h1><ul><li><p><a href="https://github.com/chrislusf/seaweedfs/wiki" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/wiki</a></p></li><li><p><a href="https://github.com/chrislusf/seaweedfs/issues" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/issues</a></p></li><li><p><a href="https://github.com/chrislusf/seaweedfs/community" target="_blank" rel="noopener">https://github.com/chrislusf/seaweedfs/community</a></p></li></ul></div><div><div id="wechat_subscriber" style="display:block;padding:10px 0;margin:20px auto;width:100%;text-align:center"><img id="wechat_subscriber_qcode" src="/images/wechat-qcode.jpg" alt="ghostsf wechat" style="width:200px;max-width:100%"><div>一个有点意思的公号</div></div></div><div class="post-share">分享到：</div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div></div><button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'><span>赞赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/images/wechatpay.png" alt="ghostsf 微信扫一扫，向我赞赏"><p>微信扫一扫，向我赞赏</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="/images/alipay.png" alt="ghostsf 支付宝扫一扫，向我赞赏"><p>支付宝扫一扫，向我赞赏</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> ghostsf</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://ghostsf.com/seaweedfs/" title="简单且高度可扩展的分布式文件系统SeaweedFS">https://ghostsf.com/seaweedfs/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/SeaweedFS/" rel="tag"># SeaweedFS</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" rel="tag"># 分布式</a> <a href="/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" rel="tag"># 文件系统</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/qnmlgb/" rel="next" title="《江湖风云录之民谣》何教授2019 带歌词"><i class="fas fa-angle-left"></i> 《江湖风云录之民谣》何教授2019 带歌词</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/how2learn/" rel="prev" title="如何学习新技术？">如何学习新技术？ <i class="fas fa-angle-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="disqus_thread"><div id="dsqjs"><section class="dsqjs-info"><p id="dsqjs-load-disqus" class="dsqjs-message">评论完整模式加载中...如果长时间无法加载，请针对 disq.us | disquscdn.com | disqus.com 启用代理</p></section></div></div></div><script type="text/javascript">window.DISQUS=null,new DisqusJS({shortname:"ghostsf",siteName:"Hi,ghostsf",identifier:"seaweedfs/",url:"https://ghostsf.com/seaweedfs/",api:"https://disqus.skk.moe/disqus/",apikey:"9WSWCTw86Za2KgcBLJG6RFulyrqgBhHlDKysX34fdT0xxbVM5Rsbg8j5loQRY30m",admin:"ghostsf",adminLabel:"ghostsf"})</script></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">关于我</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/dsl-avatar.jpeg" alt="ghostsf"><p class="site-author-name" itemprop="name"><span style="opacity:.2">全栈菜鸟</span>ghostsf</p><p class="site-description motion-element" itemprop="description">Do what i love !</p></div><div class="links-of-author motion-element"><span class="links-of-author-item scaleup"><a href="https://twitter.com/ghostsf0501" target="_blank" title="Twitter"><i class="fab fa-twitter" style="color:#2fb0ec"><span>ghostsf</span></i></a> </span><span class="links-of-author-item scaleup"><a href="https://space.bilibili.com/10825269" target="_blank" title="bilibili"><i style="fill:#20b0e3"><svg t="1581180571735" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1122"><path d="M813.2864 234.5216h-53.0176l46.3872-46.3872c19.8912-19.8912 19.8912-59.648 0-79.5136s-59.648-19.8912-79.5136 0l-132.5312 125.9008h-159.0272l-132.5312-125.9008c-19.8912-19.8912-59.648-19.8912-79.5136 0s-19.8912 59.648 0 79.5136l46.3872 46.3872H216.9088c-92.7744 0-165.6576 72.8832-165.6576 165.6576v357.8112c0 99.4048 72.8832 172.288 165.6576 172.288h589.7216c92.7744 0 165.6576-72.8832 165.6576-165.6576V400.1792c6.6304-92.7744-66.2528-165.6576-159.0272-165.6576z m46.3872 523.4688a59.392 59.392 0 0 1-59.648 59.648H223.5392a59.392 59.392 0 0 1-59.648-59.648V406.8096a59.392 59.392 0 0 1 59.648-59.648h576.4864a59.392 59.392 0 0 1 59.648 59.648v351.1808z m-516.864-291.5328a59.392 59.392 0 0 0-59.648 59.648v59.648c0 33.1264 26.496 59.648 59.648 59.648s59.648-26.496 59.648-59.648v-59.648a59.392 59.392 0 0 0-59.648-59.648z m344.576 0a59.392 59.392 0 0 0-59.648 59.648v59.648c0 33.1264 26.496 59.648 59.648 59.648s59.648-26.496 59.648-59.648v-59.648a59.392 59.392 0 0 0-59.648-59.648z" p-id="1123"></path></svg><span>ghostsf</span></i></a> </span><span class="links-of-author-item scaleup"><a href="https://github.com/ghostsf" target="_blank" title="GitHub"><i class="fab fa-github" style="color:#191717"><span>ghostsf</span></i></a> </span><span class="links-of-author-item scaleup"><a href="https://hacpai.com/member/ghostsf" target="_blank" title="黑客派"><i><svg viewBox="0 0 32 32"><path fill="#d23f31" d="M5.787 17.226h17.033l5.954 9.528c0.47 0.752 0.003 1.361-1.042 1.361h-15.141z"></path><path d="M10.74 3.927h17.033c1.045 0 1.512 0.609 1.042 1.361l-5.954 9.528h-19.872l6.379-10.209c0.235-0.376 0.849-0.681 1.372-0.681z"></path><path d="M2.953 17.226h2.839l6.804 10.889h-1.892c-0.523 0-1.137-0.305-1.372-0.681z"></path></svg><span>ghostsf</span></i></a> </span><span class="links-of-author-item scaleup"><a href="/atom.xml" target="_blank" title="RSS"><i style="fill:#f78422"><svg t="1581190724531" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16212"><path d="M512 0a512 512 0 1 0 512 512A512 512 0 0 0 512 0z m-130.72 736a71.84 71.84 0 0 1-38.72 38.4 74.24 74.24 0 0 1-56.8 0 72.64 72.64 0 0 1-38.4-38.4 73.44 73.44 0 0 1 16-80 72.48 72.48 0 0 1 22.88-16 72.96 72.96 0 0 1 96 96z m192 32a51.84 51.84 0 0 1-88.32-36.64 187.52 187.52 0 0 0-15.2-75.04 194.08 194.08 0 0 0-102.72-102.72 186.72 186.72 0 0 0-75.04-15.2 51.84 51.84 0 0 1 0-103.52 284.64 284.64 0 0 1 115.2 23.52 300.64 300.64 0 0 1 157.76 157.76 284.96 284.96 0 0 1 23.52 115.2 49.92 49.92 0 0 1-15.52 37.44z m195.84 0a51.84 51.84 0 0 1-88.48-36.64 378.72 378.72 0 0 0-13.92-103.2 393.92 393.92 0 0 0-39.2-92.96 389.92 389.92 0 0 0-232.48-177.76 380 380 0 0 0-103.2-13.92 51.84 51.84 0 0 1-36.64-88.48 49.92 49.92 0 0 1 36.48-15.04 483.2 483.2 0 0 1 130.72 17.6 494.08 494.08 0 0 1 344 344 483.2 483.2 0 0 1 17.6 130.72 50.08 50.08 0 0 1-15.2 36.48z" p-id="16213"></path></svg><span>RSS</span></i></a> </span><span class="links-of-author-item scaleup"><a href="javascript:;" target="_blank" title="NS"><i style="fill:#e60012"><svg t="1581180843998" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4383"><path d="M255.69989 67c-89.2 16-161 82-183.6 168.8C63.89989 267.2 63.29989 285.6 64.29989 528.8 64.69989 752 64.89989 757.2 68.69989 774.6c20.6 93 86.6 159.2 180.6 181 12.2 2.8 27.8 3.4 128.2 3.8 103.8 0.8 114.6 0.6 117.4-2.2 2.8-2.8 3-38.6 3-444.4 0-301-0.6-442.6-1.8-445.2-1.8-3.4-5-3.6-113.8-3.4-88.4 0.2-115 0.8-126.6 2.8z m167.8 445.2V888l-75.6-1c-69.6-0.8-77-1.2-91-4.6-59.8-15.4-104-61.4-116.6-121.4-4-18.8-4-480.2-0.2-498.6 11.2-52.2 47.4-95.4 96-114.8 24.4-9.8 35.8-11 115.2-11.2l71.8-0.2v376z m-151.8-262.4c-11.6 2.2-29.4 11.2-39 19.4-19.4 16.8-29.2 40.8-27.6 69 0.8 14.6 1.6 18.6 7.6 30.4 8.8 18 21.8 31.2 39.8 40 12.4 6.2 15.6 6.8 31.8 7.4 14.6 0.6 19.8 0 29.6-3.4 40.2-13.6 64.6-52.6 57.6-92.8-7.8-47.4-53.2-79.4-99.8-70z m316.4-184.6c-0.8 0.6-1.2 201.6-1.2 447 0 404.6 0.2 445.6 3 446.8 5 1.8 149 1.2 166.8-0.8 75.4-8.6 142-54.4 178-122.4 4.6-8.8 10.8-23.4 14-32.4 11.6-34.8 11.4-25.6 11.4-292.2 0-212.8-0.4-244.6-3-258-18.4-96.6-92.2-169.6-189-186.2-13-2.2-33-2.8-97.6-2.8-44.8-0.2-81.8 0.4-82.4 1z m198.2 404.2c29 7.6 52.6 29.6 62.4 57.8 6.2 17.4 6 43-0.2 59-11.4 29.4-33.6 50-62.2 57.6-46.4 12-95.8-16-109.2-62-4-14-3.8-37.8 0.8-52.4 13.8-45.4 62-72.2 108.4-60z" p-id="4384"></path></svg><span>SW-6691-4805-8207</span></i></a></span></div><details class="views-top-wrap"><summary class="views-top-name scaleup">看爆 Top5</summary><ul class="views-top"></ul></details></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0x00-概述"><span class="nav-number">1.</span> <span class="nav-text">0x00 概述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x01-基础概念"><span class="nav-number">2.</span> <span class="nav-text">0x01 基础概念</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x02-组成部分"><span class="nav-number">3.</span> <span class="nav-text">0x02 组成部分</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x03-快速上手"><span class="nav-number">4.</span> <span class="nav-text">0x03 快速上手</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#配置运行Weed-Master-server"><span class="nav-number">4.1.</span> <span class="nav-text">配置运行Weed Master server</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置运行Weed-Volume-Server"><span class="nav-number">4.2.</span> <span class="nav-text">配置运行Weed Volume Server</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试SeaweedFS"><span class="nav-number">4.3.</span> <span class="nav-text">测试SeaweedFS</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x04-在docker中使用"><span class="nav-number">5.</span> <span class="nav-text">0x04 在docker中使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#使用compose"><span class="nav-number">5.1.</span> <span class="nav-text">使用compose</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#从dockerfile构建image"><span class="nav-number">5.2.</span> <span class="nav-text">从dockerfile构建image</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#构建docker-image"><span class="nav-number">5.3.</span> <span class="nav-text">构建docker image</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生产使用"><span class="nav-number">5.4.</span> <span class="nav-text">生产使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x05-组成部分介绍"><span class="nav-number">6.</span> <span class="nav-text">0x05 组成部分介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Master-Server"><span class="nav-number">6.1.</span> <span class="nav-text">Master Server</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#分配一个fileId，用于接下来的存储文件"><span class="nav-number">6.1.1.</span> <span class="nav-text">分配一个fileId，用于接下来的存储文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查询"><span class="nav-number">6.1.2.</span> <span class="nav-text">查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#强制垃圾收集"><span class="nav-number">6.1.3.</span> <span class="nav-text">强制垃圾收集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#预分配卷"><span class="nav-number">6.1.4.</span> <span class="nav-text">预分配卷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除文件集"><span class="nav-number">6.1.5.</span> <span class="nav-text">删除文件集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#检查系统状态"><span class="nav-number">6.1.6.</span> <span class="nav-text">检查系统状态</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Volume-Server"><span class="nav-number">6.2.</span> <span class="nav-text">Volume Server</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#上传文件"><span class="nav-number">6.2.1.</span> <span class="nav-text">上传文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#直接上传文件"><span class="nav-number">6.2.2.</span> <span class="nav-text">直接上传文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#访问文件"><span class="nav-number">6.2.3.</span> <span class="nav-text">访问文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除文件"><span class="nav-number">6.2.4.</span> <span class="nav-text">删除文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看分块大文件的清单文件内容"><span class="nav-number">6.2.5.</span> <span class="nav-text">查看分块大文件的清单文件内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#检查卷服务器状态"><span class="nav-number">6.2.6.</span> <span class="nav-text">检查卷服务器状态</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Filer-Server"><span class="nav-number">6.3.</span> <span class="nav-text">Filer Server</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#配置启动"><span class="nav-number">6.3.1.</span> <span class="nav-text">配置启动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#管理文件"><span class="nav-number">6.3.2.</span> <span class="nav-text">管理文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#列出目录下的文件"><span class="nav-number">6.3.3.</span> <span class="nav-text">列出目录下的文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除"><span class="nav-number">6.3.4.</span> <span class="nav-text">删除</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#删除文件-1"><span class="nav-number">6.3.4.1.</span> <span class="nav-text">删除文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除文件夹"><span class="nav-number">6.3.4.2.</span> <span class="nav-text">删除文件夹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#说明"><span class="nav-number">6.3.5.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mount挂载"><span class="nav-number">6.3.6.</span> <span class="nav-text">mount挂载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Amazon-S3-API"><span class="nav-number">6.3.7.</span> <span class="nav-text">Amazon S3 API</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x06-异步备份"><span class="nav-number">7.</span> <span class="nav-text">0x06 异步备份</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#异步复制到另一个Filer"><span class="nav-number">7.1.</span> <span class="nav-text">异步复制到另一个Filer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#备份到云"><span class="nav-number">7.2.</span> <span class="nav-text">备份到云</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x07-进阶"><span class="nav-number">8.</span> <span class="nav-text">0x07 进阶</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#复写配置"><span class="nav-number">8.1.</span> <span class="nav-text">复写配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#怎么用？"><span class="nav-number">8.1.1.</span> <span class="nav-text">怎么用？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#复写类型的含义"><span class="nav-number">8.1.2.</span> <span class="nav-text">复写类型的含义</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#大文件处理"><span class="nav-number">8.2.</span> <span class="nav-text">大文件处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安全配置"><span class="nav-number">8.3.</span> <span class="nav-text">安全配置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x08-各语言的客户端"><span class="nav-number">9.</span> <span class="nav-text">0x08 各语言的客户端</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x09-不足与问题"><span class="nav-number">10.</span> <span class="nav-text">0x09 不足与问题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x0A-遇到问题怎么办"><span class="nav-number">11.</span> <span class="nav-text">0x0A 遇到问题怎么办</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-image"></div><div class="footer-inner"><p>博客已萌萌哒运行<span id="since"></span><span class="my-face">(●'◡'●)ﾉ♥</span></p><p>托管于<a href="https://github.com/" target="_blank" rel="nofollow"> GitHub</a>. <a href="https://www.upyun.com/" target="_blank" rel="nofollow">又拍云</a> 提供 CDN 服务. <a href="http://www.google.com/analytics/" target="_blank" rel="nofollow">Google Analytics </a>提供网站统计服务. <a href="https://www.dnspod.com/" target="_blank" rel="nofollow">DNSPod </a>提供 DNS 解析服务.</p><p>© 2015-<span itemprop="copyrightYear">2020</span> Hi,ghostsf. 由 <a href="https://hexo.io/" target="_blank" class="external" rel="nofollow">Hexo</a> 强力驱动. Theme By <a href="https://github.com/ghostsf/hexo-theme-xiao" target="_blank" class="external" rel="nofollow">xiao</a> v0.1.0. <a href="/sitemap.xml" target="_blank">站点地图</a>. <a href="http://www.beian.miit.gov.cn" target="_blank" rel="nofollow">苏ICP备15036367号</a>.</p><p>Made with <i class="fas fa-heart throb" style="color:#d43f57"></i> by <span class="author" itemprop="copyrightHolder">ghostsf</span>.</p></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div><canvas id="evanyou"></canvas><div id="aplayer-fixed"></div></div><script type="text/javascript" src="/js/xiao.min.js?v=0.1.0"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>var serviceWorkerUri="/sw.js";"serviceWorker"in navigator?navigator.serviceWorker.register(serviceWorkerUri).then(function(){navigator.serviceWorker.controller?console.log("Assets cached by the controlling service worker."):console.log("Please reload this page to allow the service worker to handle network operations.")}).catch(function(e){console.log("ERROR: "+e)}):console.log("Service workers are not supported in the current browser.")</script></body></html>